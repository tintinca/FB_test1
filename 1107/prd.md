# 明信片收藏夹 V1 PRD

## 1. 产品使命
为明信片收集爱好者提供一款“即开即用、无需登录、数据本地存储”的轻量级 Web 工具，10 秒完成录入，1 秒搜到目标卡片。

## 2. 目标用户
明信片收集爱好者（国内外邮品、旅游纪念品、艺术卡等）
核心痛点：
- 收藏量大，用 Excel/文件夹管理图片麻烦
- 找不到某张卡片的“国家/年份/标签”
- 想快速导出清单备份或分享

## 3. 用户画像（单用户版）
- 年龄 25-60，男女均衡
- 收藏数量 100-5000 张
- 使用场景：在家用电脑整理新入手的卡片，偶尔导出 CSV 备份
- 不接受强制注册，希望数据完全私有

## 4. 版本规划
### V1 MVP（单页 HTML，零后端）
- 单用户，IndexedDB 本地存储
- 字段：正面图*、标题*、国家*、年份、标签、是否实寄、备注
- 仅支持 1 张正面图上传（可拖拽）
- 首页 4 列网格瀑布流，按录入时间倒序
- 顶部搜索：标题 + 国家 + 标签 全文匹配
- 新增/编辑：字段校验 + 图片压缩（最长边 1200px）
- 导出 CSV（含图片文件名，方便备份）
- 桌面端优先，无需适配手机
- 单色系 UI，无深色/浅色切换

### V2+（后续迭代）
- 背面图 & 多张细节图
- 批量上传 + 自动命名
- OCR 识别邮戳/文字，自动填入国家/年份
- 高级筛选：年份区间、实寄复选、标签多选
- 地图视图（按国家定位）
- 云同步（WebDAV / Firebase）
- 分享单张卡片生成海报图
- 会员版：高清图备份、批量导出 PDF 目录册

## 5. 关键业务规则
- 图片 ≤ 5 MB，自动压缩至最长边 1200 px，JPEG 80% 质量
- 标签用英文逗号分隔，去重、首尾空格自动清除
- 搜索不区分大小写，空格分隔“与”关系
- 删除卡片时同步删除 IndexedDB 内图片文件，不可恢复
- CSV 导出时图片文件以 `{id}.jpg` 命名，保存到浏览器下载文件夹

## 6. 数据契约（V1）
```ts
interface Postcard {
  id: string;               // UUID
  title: string;            // 必填
  country: string;          // 必填
  year?: number;            // 4 位数字
  tags: string[];           // 标签数组
  isPosted: boolean;        // 是否实寄
  note?: string;            // 备注
  frontImage: Blob;         // 压缩后的 JPEG
  createdAt: number;        // 时间戳
}
```

## 7. 交互流程（概念 C｜顶部工具栏 + 网格 4 列）
```
┌----------------------------------┐
│ 🎴 明信片收藏夹 · 导出CSV        │
├----------------------------------┤
│ [搜索…] [+新增] [导出CSV]       │
├----------------------------------┤
│ 网格 4 列                        │
│ ┌---┐ ┌---┐ ┌---┐ ┌---┐       │
│ │图│ │图│ │图│ │图│           │
│ │标题│ │标题│ │标题│ │标题│    │
│ └---┘ └---┘ └---┘ └---┘       │
│                                  │
│ 点击卡片进入编辑弹窗             │
└----------------------------------┘
```
- 点击卡片 → 编辑弹窗（字段同新增）
- 点击[+新增] → 新增弹窗（同编辑）
- 搜索实时过滤网格

## 8. 架构蓝图（单页 HTML）
- 技术：原生 HTML + CSS + JS，零依赖，IndexedDB 本地存储
- 模块：
  - `db.js`：IndexedDB 封装、图片压缩
  - `render.js`：网格渲染、搜索高亮、弹窗管理
  - `export.js`：CSV 拼接、下载
- 流程：
  1) 首次访问 → 初始化 DB → 加载所有卡片 → 渲染网格
  2) 新增/编辑 → 压缩图片 → 写入 DB → 刷新网格
  3) 搜索 → 全文过滤 → 重新渲染
  4) 导出 → 生成 CSV + 图片包 → 浏览器下载
- 性能：1000 张卡片本地查询 < 100 ms

## 9. 风险与对策
| 风险 | 对策 |
|------|------|
| IndexedDB 兼容性 | 使用 idb 库降级 |
| 大图片阻塞 | 分片读取 + Loading UI |
| 单页体积 | Gzip 后 < 200 KB，图片压缩后存储 |

## 10. 验收标准
- 首次打开 1 秒内出现网格
- 新增卡片 10 秒内完成（含图片压缩）
- 搜索 500 张卡片 < 100 ms
- 导出 1000 张 CSV < 3 秒
- 删除后图片文件同步清除，无残留

## 11. 里程碑
- M1 编码完成：单页 HTML + 所有 MVP 功能（3 天）
- M2 自测通过：1000 张卡片压力测试（1 天）
- M3 交付：源码 + 使用说明（1 天）

---
本 PRD 为 V1 最终版，后续迭代请另起文档。